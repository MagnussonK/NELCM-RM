<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>The Childrens Museum - Unified Record Manager</title>

<link href="logo.png" rel="icon" type="image/png"/>
<style>
        /* Global Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #faf9ff; /* Light background color */
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to top */
            min-height: 100vh;
            padding: 1.5rem;
        }
        .main-container {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.1), 0 4px 8px -2px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 6xl; /* Increased max-width for overall app */
            border: 1px solid #e2e8f0;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }

        /* Section/View Specific Containers */
        .view-container {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.1), 0 4px 8px -2px rgba(0, 0, 0, 0.05);
            width: 100%;
            border: 1px solid #e2e8f0;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }
        #homeView { max-width: 6xl; }
        #addRecordView { max-width: 3xl; }
        #familyDetailsView { max-width: 5xl; }
        #recordDetailsView { max-width: 3xl; }
        #manageSecondaryMembersView { max-width: 4xl; }
        #addVisitView { max-width: 3xl; } /* New view for adding visits */
        #memberVisitsView { max-width: 4xl; } /* New view for displaying member visits */
        #accountManagementView { max-width: 3xl; } /* New view for account management */


        /* Form Group Styles */
        .form-group {
            margin-bottom: 1.25rem;
        }
        label {
            display: block;
            font-weight: 600;
            color: #4b5563; /* gray-600 */
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="number"],
        input[type="date"],
        input[type="datetime-local"], /* Added for visit_datetime */
        input[type="password"], /* Added for password fields */
        select,
        textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #cbd5e0; /* gray-300 */
            border-radius: 0.5rem;
            font-size: 1rem;
            color: #1f2937; /* gray-900 */
            transition: all 0.2s ease-in-out;
        }
        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus,
        input[type="number"]:focus,
        input[type="date"]:focus,
        input[type="datetime-local"]:focus, /* Added for visit_datetime */
        input[type="password"]:focus, /* Added for password fields */
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #5E237C; /* Custom purple from logo */
            box-shadow: 0 0 0 3px rgba(94, 35, 124, 0.25); /* Custom purple with opacity */
        }
        input:disabled {
            background-color: #e5e7eb;
            cursor: not-allowed;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 1.25rem;
        }
        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin-right: 0.75rem;
            transform: scale(1.2); /* Slightly larger checkbox */
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
            margin-top: 2rem;
        }
        .action-button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .btn-primary {
            background-color: #5E237C; /* Custom purple from logo */
            color: white;
            border: 1px solid #5E237C;
        }
        .btn-primary:hover {
            background-color: #4A1C63; /* Darker purple for hover */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .btn-secondary {
            background-color: #99CC33; /* Custom green from logo */
            color: #374151; /* Dark gray for contrast */
            border: 1px solid #99CC33;
        }
        .btn-secondary:hover {
            background-color: #7AA329; /* Darker green for hover */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .btn-delete {
            background-color: #ef4444; /* red-500 */
            color: white;
            border: 1px solid #ef4444;
        }
        .btn-delete:hover {
            background-color: #dc2626; /* red-600 */
        }

        /* Message Box */
        .message-box {
            padding: 0.75rem;
            margin-bottom: 1.5rem;
            border-radius: 0.5rem;
            text-align: center;
            font-weight: 500;
        }
        .message-box.success {
            background-color: #d1fae5; /* green-100 */
            color: #065f46; /* green-800 */
        }
        .message-box.error {
            background-color: #fee2e2; /* red-100 */
            color: #991b1b; /* red-800 */
        }

        /* Table Styles (for home and manage secondary members) */
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        th {
            background-color: #e2e8f0;
            color: #4a5568;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.75rem;
        }
        tr:hover {
            background-color: #f7fafc;
        }
        .overflow-x-auto::-webkit-scrollbar {
            height: 8px;
        }
        .overflow-x-auto::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .overflow-x-auto::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .overflow-x-auto::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Specific Row Styles for Home View */
        .selected-row {
            background-color: #bfdbfe; /* Light blue for selected row */
            border-left: 4px solid #3b82f6; /* Blue border to highlight */
        }
        .expired-membership-row {
            background-color: #fee2e2; /* Tailwind red-100 */
        }
        .expired-membership-row:hover {
            background-color: #fecaca; /* Tailwind red-200 */
        }
        .expiring-soon-row {
            background-color: #fcd34d; /* More prominent amber color (Tailwind amber-300) */
        }
        .expiring-soon-row:hover {
            background-color: #fbbf24; /* Darker amber on hover (Tailwind amber-400) */
        }
        .founding-family-row {
            background-color: #dcfce7; /* Tailwind green-100 */
        }
        .founding-family-row:hover {
            background-color: #bbf7d0; /* Slightly darker green on hover */
        }
        .missing-info-row {
            border-left: 4px solid #f59e0b; /* Yellow border for missing info */
        }
        .missing-info-row:hover {
            background-color: #fff7e6; /* Lighter yellow on hover */
        }
        @keyframes sparkle-pulse {
            0% { background-position: 0% 50%; transform: scale(1); }
            50% { background-position: 100% 50%; transform: scale(1.005); }
            100% { background-position: 0% 50%; transform: scale(1); }
        }
        .sparkly-birthday-row {
            /* Adjusted to new theme colors */
            background: linear-gradient(90deg, #d8b4fe, #a78bfa, #5E237C, #a78bfa, #d8b4fe);
            background-size: 300% 100%;
            animation: sparkle-pulse 4s infinite linear;
            font-weight: bold;
            color: #fff; /* White text for contrast */
            border: 3px solid #5E237C; /* Custom purple border */
            box-shadow: 0 0 15px rgba(94, 35, 124, 0.8), 0 0 25px rgba(94, 35, 124, 0.5);
            transform: translateZ(0);
            position: relative;
            z-index: 10;
        }
        .sparkly-birthday-row:hover {
            background-color: #4A1C63; /* Darker purple on hover */
            box-shadow: 0 0 20px rgba(94, 35, 124, 1), 0 0 35px rgba(94, 35, 124, 0.7);
        }

        /* Toggle Switch Styles */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #99CC33; /* Custom green */
        }
        input:focus + .slider {
            box-shadow: 0 0 1px #99CC33;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Family Details Specific Styles */
        .section-header {
            font-size: 1.5rem;
            font-weight: 700;
            color: #374151; /* gray-700 */
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #e5e7eb; /* gray-200 */
        }
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .detail-item {
            display: flex;
            flex-direction: column;
            padding: 0.75rem;
            background-color: #f9fafb; /* gray-50 */
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
        }
        .detail-label {
            font-weight: 600;
            color: #4b5563; /* gray-600 */
            font-size: 0.875rem; /* text-sm */
            margin-bottom: 0.25rem;
        }
        .detail-value {
            color: #1f2937; /* gray-900 */
            font-size: 1rem;
            word-break: break-word;
        }
        .member-card {
            background-color: #f3f4f6; /* gray-100 */
            padding: 1.25rem;
            border-radius: 0.75rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .member-card-header {
            font-size: 1.125rem; /* text-lg */
            font-weight: 600;
            color: #1f2937;
            border-bottom: 1px solid #d1d5db; /* gray-300 */
            padding-bottom: 0.5rem;
            margin-bottom: 0.75rem;
        }
        .member-card-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem 1rem;
        }
        .member-card-detail-item {
            display: flex;
            flex-direction: column;
        }
        .member-card-detail-label {
            font-weight: 500;
            color: #6b7280; /* gray-500 */
            font-size: 0.8rem;
        }
        .member-card-detail-value {
            color: #374151; /* gray-700 */
            font-size: 0.9rem;
        }
        .membership-action-group {
            display: flex;
            align-items: flex-end;
            gap: 1rem;
            margin-top: 1rem;
        }
        /* Visit cards in the new view */
        .visit-card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }
        .visit-card {
            background-color: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            font-size: 0.95rem;
            color: #374151;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        .visit-card strong {
            color: #1f2937;
        }
        .all-visits-scroll-area {
            max-height: 250px; /* Fixed height for scrollable area */
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            background-color: #f9fafb;
        }
        .all-visits-scroll-area p {
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px dashed #e5e7eb;
        }
        .all-visits-scroll-area p:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        /* Calendar Styles */
        .calendar {
            width: 100%;
            max-width: 400px; /* Max width for the calendar */
            margin: 1.5rem auto;
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            padding: 1rem;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            font-size: 1.25rem;
            font-weight: 600;
            color: #374151;
        }
        .calendar-header button {
            background-color: #E9D5FF; /* Light purple from theme */
            color: #5E237C; /* Custom purple from logo */
            border: none;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s ease-in-out;
        }
        .calendar-header button:hover {
            background-color: #D8B4FE; /* Darker light purple */
        }
        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            font-weight: 600;
            color: #6b7280; /* gray-500 */
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.25rem;
            text-align: center;
        }
        .calendar-day {
            padding: 0.75rem 0.5rem;
            border-radius: 0.5rem;
            background-color: #f9fafb; /* gray-50 */
            color: #1f2937;
            font-size: 0.9rem;
            min-height: 40px; /* Ensure consistent height */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .calendar-day.empty {
            background-color: transparent;
            border: none;
        }
        .calendar-day.current-day {
            background-color: #bfdbfe; /* blue-200 */
            font-weight: bold;
            color: #1e40af; /* blue-800 */
            border: 1px solid #60a5fa; /* blue-400 */
        }
        .calendar-day.visited-day {
            background-color: #d1fae5; /* green-100 */
            font-weight: bold;
            color: #065f46; /* green-800 */
            border: 1px solid #34d399; /* green-400 */
            box-shadow: 0 0 5px rgba(52, 211, 153, 0.5);
        }
        .calendar-day.visited-day.current-day {
            background-color: #a7f3d0; /* green-200 */
            border-color: #10b981; /* green-500 */
        }
    
/* Enhanced color scheme based on logo */
h1, h2, h3, .section-header {
    color: #5E237C;
}
.btn-primary {
    background-color: #5E237C;
    border-color: #5E237C;
}
.btn-primary:hover {
    background-color: #4A1C63;
}
.btn-secondary {
    background-color: #99CC33;
    border-color: #99CC33;
}
.btn-secondary:hover {
    background-color: #7AA329;
}
.view-container, .main-container {
    border-color: #DDD6F3;
    box-shadow: 0 10px 25px rgba(94, 35, 124, 0.1);
}
input:focus, select:focus, textarea:focus {
    border-color: #5E237C;
    box-shadow: 0 0 0 3px rgba(94, 35, 124, 0.25);
}
</style>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
<div class="main-container">
<div class="text-center mb-6">
<img alt="The Childrens Museum Logo" class="mx-auto h-20 sm:h-24 mb-4" src="logo.png"/>
</div>
<div class="hidden p-3 mb-6 rounded-lg text-center font-medium transition-opacity duration-300 ease-in-out" id="messageBox" role="alert"></div>
<div class="hidden text-center my-8 text-blue-600 font-semibold text-lg" id="globalLoadingIndicator">
<svg class="animate-spin h-8 w-8 mx-auto mb-3" viewbox="0 0 24 24">
<circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
<path class="opacity-75" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" fill="currentColor"></path>
</svg>
<p>Processing request, please wait...</p>
</div>
<section class="view-container" id="homeView">
<h1 class="text-3xl font-extrabold text-center text-gray-900 mb-6">
<span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-800 to-indigo-900">
                    Record Manager
                </span>
</h1>
<div class="flex flex-col sm:flex-row items-center justify-between mb-8 space-y-4 sm:space-y-0 sm:space-x-6">
<button class="w-full sm:w-auto flex-shrink-0 bg-gradient-to-r from-purple-800 to-indigo-900 text-white py-3 px-8 rounded-full font-semibold text-lg hover:from-purple-900 hover:to-indigo-950 focus:outline-none focus:ring-4 focus:ring-purple-300 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg" id="homeFetchDataBtn">
<svg class="animate-spin h-5 w-5 mr-3 hidden" id="homeRefreshSpinner" viewbox="0 0 24 24">
<circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
<path class="opacity-75" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" fill="currentColor"></path>
</svg>
                    Refresh Data
                </button>
<button class="w-full sm:w-auto flex-shrink-0 bg-gradient-to-r from-lime-500 to-green-600 text-white py-3 px-8 rounded-full font-semibold text-lg hover:from-lime-600 hover:to-green-700 focus:outline-none focus:ring-4 focus:ring-lime-300 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg" id="homeAddRecordBtn">
                    Add New Record
                </button>
<div class="w-full sm:w-auto flex-grow flex items-center bg-gray-100 border border-gray-300 rounded-full py-2 px-4 shadow-inner focus-within:ring-2 focus-within:ring-purple-500 transition duration-200">
<input class="flex-grow bg-transparent p-1 text-gray-800 placeholder-gray-500 outline-none" id="homeLastNameSearch" placeholder="Search by Last Name (type to filter)..." type="text"/>
<svg class="h-6 w-6 text-gray-500 ml-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke-linecap="round" stroke-linejoin="round"></path>
</svg>
</div>
<div class="flex items-center space-x-2">
<label class="text-gray-700 font-medium" for="showInactiveToggle">Show Inactive Accounts:</label>
<label class="toggle-switch">
<input id="showInactiveToggle" type="checkbox"/>
<span class="slider"></span>
</label>
</div>
</div>
<div class="mt-8 bg-gray-50 p-6 rounded-xl border border-gray-200 shadow-inner overflow-x-auto max-h-96" id="homeResultsContainer">
<h2 class="text-xl font-bold text-gray-800 mb-4">Current Records:</h2>
<div class="bg-white rounded-lg text-gray-800 text-sm overflow-hidden" id="homeDataResults">
<p class="text-center text-gray-500 py-4">Loading data...</p>
</div>
</div>
<div class="mt-8 p-4 bg-gray-100 rounded-lg border border-gray-200 text-center text-gray-700 font-semibold flex flex-col sm:flex-row justify-around items-center space-y-2 sm:space-y-0">
<div class="flex items-center space-x-2">
<svg class="h-6 w-6 text-purple-600" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M17 20h-5v-2a3 3 0 013-3h2a3 3 0 013 3v2h-5z" stroke-linecap="round" stroke-linejoin="round"></path>
<path d="M11 10a3 3 0 11-6 0 3 3 0 016 0zm-7 8a4 4 0 014-4h4a4 4 0 014 4v2H4v-2z" stroke-linecap="round" stroke-linejoin="round"></path>
</svg>
<span id="homeMemberCount">Total Active Family Members: 0</span>
</div>
<div class="flex items-center space-x-2">
<svg class="h-6 w-6 text-lime-600" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m0 0l7 7m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" stroke-linecap="round" stroke-linejoin="round"></path>
</svg>
<span id="homeUniqueMemberCount">Total Active Families: 0</span>
</div>
<div class="flex items-center space-x-2 cursor-pointer hover:bg-gray-200 p-2 rounded-lg transition-colors" id="visitsTodayContainer">
<svg class="h-6 w-6 text-green-600" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" stroke-linecap="round" stroke-linejoin="round"></path>
</svg>
<span id="homeVisitsTodayCount">Visits Today: 0</span>
</div>
</div>
<div class="mt-8 text-center flex flex-wrap justify-center items-center gap-4">
<button class="bg-gradient-to-r from-purple-800 to-indigo-900 text-white py-3 px-8 rounded-full font-semibold text-lg hover:from-purple-900 hover:to-indigo-950 focus:outline-none focus:ring-4 focus:ring-purple-300 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg" id="homeGenerateReportBtn">
                    Generate Member Report
                </button>
<button class="bg-gradient-to-r from-blue-500 to-teal-600 text-white py-3 px-8 rounded-full font-semibold text-lg hover:from-blue-600 hover:to-teal-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition duration-300 ease-in-out transform hover:scale-105 shadow-lg" id="homeSendEmailsBtn">
                    Send Renewal Emails
                </button>

</div>
</section>
<section class="view-container hidden" id="addRecordView">
<h1 class="text-3xl font-extrabold text-center text-gray-900 mb-6" id="addRecordHeader">
<span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-800 to-indigo-900">
                    Add New Member Record
                </span>
</h1>
<form id="addRecordForm">
<div class="form-group">
<label for="addName">First Name:</label>
<input id="addName" required="" type="text"/>
</div>
<div class="form-group">
<label for="addLastName">Last Name:</label>
<input id="addLastName" required="" type="text"/>
</div>
<div class="form-group">
<label for="addEmail">Email:</label>
<input id="addEmail" type="email"/>
</div>
<div class="form-group">
<label for="addPhone">Phone:</label>
<input id="addPhone" placeholder="e.g., 123-456-7890" type="tel"/>
</div>
<div class="form-group">
<label for="addAddress">Address:</label>
<input id="addAddress" type="text"/>
</div>
<div class="form-group">
<label for="addCity">City:</label>
<input id="addCity" required="" type="text"/>
</div>
<div class="form-group">
<label for="addState">State:</label>
<input id="addState" maxlength="2" placeholder="e.g., LA" type="text"/>
</div>
<div class="form-group">
<label for="addZipCode">Zip Code:</label>
<input id="addZipCode" pattern="[0-9]{5}(-[0-9]{4})?" placeholder="e.g., 71291 or 71291-1234" type="text"/>
</div>
<div class="form-group">
<label for="addBirthday">Birthday:</label>
<input id="addBirthday" type="date"/>
</div>
<div class="form-group">
<label for="addGender">Gender:</label>
<select id="addGender">
<option value="">Select Gender</option>
<option value="true">Male</option>
<option value="false">Female</option>
</select>
</div>
<div class="checkbox-group">
<input id="addFoundingFamily" type="checkbox"/>
<label class="mb-0" for="addFoundingFamily">Founding Family</label>
</div>
<div class="action-buttons">
<button class="action-button btn-primary" type="submit">Add Record</button>
<button class="action-button btn-primary hidden" id="addFamilyMembersBtn" type="button">Add Family Members</button>
<button class="action-button btn-secondary" id="addRecordCancelBtn" type="button">Cancel</button>
</div>
</form>
</section>
<section class="view-container hidden" id="familyDetailsView">
<h1 class="text-3xl font-extrabold text-center text-gray-900 mb-6">
<span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-800 to-indigo-900">
                    Family Details
                </span>
</h1>
<div id="familyDetailsContent">
<section class="mb-8">
<h2 class="section-header">Family Overview (<span id="displayMemberId"></span>)</h2>
<div class="detail-grid">
<div class="detail-item">
<span class="detail-label">Address &amp; Email:</span>
<span class="detail-value" id="familyAddress"></span>
<span class="detail-value" id="familyCityStateZip"></span>
<span class="detail-value mt-2 text-indigo-600 font-semibold" id="familyEmail"></span>
</div>
<div class="detail-item" id="updateMembershipContainer">
<div class="detail-item">
<span class="detail-label">Email:</span>
<span class="detail-value" id="familyEmail"></span>
</div>
<div class="detail-item" id="updateMembershipContainer">
<span class="detail-label font-bold text-base mb-3 border-b pb-2">Membership Dates:</span>
<div class="flex items-end gap-4 pt-2">
<div class="flex-grow space-y-3">
<div>
<label class="detail-label text-sm !mb-1">Start Date:</label>
<span class="detail-value block p-2 bg-gray-200 rounded-md w-full text-center font-medium" id="familyMemStartDateDisplay"></span>
</div>
<div>
<label class="detail-label text-sm !mb-1">End Date:</label>
<span class="detail-value block p-2 bg-gray-200 rounded-md w-full text-center font-medium" id="familyMembershipExpires"></span>
</div>
</div>
<div class="flex-shrink-0">
<button class="action-button btn-primary" id="updateMembershipBtn">
                                        Update Membership
                                    </button>
</div>
</div>
</div>
</div>
</div></section>
<section>
<h2 class="section-header">Individual Family Members</h2>
<div id="individualMembersList">
<p class="text-gray-600 text-center py-4">No individual members found for this family.</p>
</div>
</section>
</div>
<div class="action-buttons">
<button class="action-button btn-primary" id="familyDetailsManageSecondaryMembersBtn">
                    Manage Secondary Members
                </button>
<button class="action-button btn-secondary" id="familyDetailsCloseBtn">
                    Close Window
                </button>
</div>
</section>
<section class="view-container hidden" id="recordDetailsView">
<h1 class="text-3xl font-extrabold text-center text-gray-900 mb-6">
<span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-800 to-indigo-900">
                    Member Details: <span id="recordDetailsMemberIdDisplay"></span>
</span>
</h1>
<form id="recordDetailForm">
<div class="form-group">
<label for="recordDetailsName">First Name:</label>
<input id="recordDetailsName" required="" type="text"/>
</div>
<div class="form-group">
<label for="recordDetailsLastName">Last Name:</label>
<input id="recordDetailsLastName" required="" type="text"/>
</div>
<div class="form-group">
<label for="recordDetailsEmail">Email:</label>
<input disabled="" id="recordDetailsEmail" type="email"/>
</div>
<div class="form-group">
<label for="recordDetailsPhone">Phone:</label>
<input id="recordDetailsPhone" type="tel"/>
</div>
<div class="form-group">
<label for="recordDetailsAddress">Address:</label>
<input disabled="" id="recordDetailsAddress" type="text"/>
</div>
<div class="form-group">
<label for="recordDetailsCity">City:</label>
<input disabled="" id="recordDetailsCity" required="" type="text"/>
</div>
<div class="form-group">
<label for="recordDetailsState">State:</label>
<input disabled="" id="recordDetailsState" maxlength="2" type="text"/>
</div>
<div class="form-group">
<label for="recordDetailsZipCode">Zip Code:</label>
<input disabled="" id="recordDetailsZipCode" type="text"/>
</div>
<div class="form-group">
<label for="recordDetailsBirthday">Birthday:</label>
<input id="recordDetailsBirthday" type="date"/>
</div>
<div class="form-group">
<label for="recordDetailsGender">Gender:</label>
<select id="recordDetailsGender">
<option value="">Select Gender</option>
<option value="true">Male</option>
<option value="false">Female</option>
</select>
</div>
<div class="checkbox-group">
<input disabled="" id="recordDetailsFoundingFamily" type="checkbox"/>
<label class="mb-0" for="recordDetailsFoundingFamily">Founding Family</label>
</div>
<div class="checkbox-group">
<input disabled="" id="recordDetailsPrimaryMember" type="checkbox"/>
<label class="mb-0" for="recordDetailsPrimaryMember">Primary Member</label>
</div>
<div class="checkbox-group">
<input disabled="" id="recordDetailsSecondaryMember" type="checkbox"/>
<label class="mb-0" for="recordDetailsSecondaryMember">Secondary Member</label>
</div>
<div class="form-group">
<label for="recordDetailsMemStartDate">Membership Start Date:</label>
<input disabled="" id="recordDetailsMemStartDate" type="date"/>
</div>
<div class="form-group" id="recordDetailsMembershipExpiresContainer">
<label for="recordDetailsMembershipExpires">Membership Expires:</label>
<input disabled="" id="recordDetailsMembershipExpires" type="date"/>
</div>
<div class="checkbox-group">
<input disabled="" id="recordDetailsActiveFlag" type="checkbox"/>
<label class="mb-0" for="recordDetailsActiveFlag">Active</label>
</div>
<div class="action-buttons">
<button class="action-button btn-primary" type="submit">Update Record</button>
<button class="action-button btn-delete" id="recordDetailsDeleteRecordBtn" type="button">Delete Record</button>
<button class="action-button btn-secondary" id="recordDetailsCloseBtn" type="button">Close</button>
</div>
</form>
</section>
<section class="view-container hidden" id="manageSecondaryMembersView">
<h1 class="text-3xl font-extrabold text-center text-gray-900 mb-6">
<span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-800 to-indigo-900">
                    Manage Family Members for: <span id="manageSecondaryFamilyIdDisplay">Loading...</span>
</span>
</h1>
<h2 class="text-xl font-bold text-gray-800 mb-4">Current Family Members:</h2>
<div class="overflow-x-auto max-h-60 mb-6 border border-gray-200 rounded-lg shadow-inner" id="manageSecondaryMembersTableContainer">
<table class="min-w-full divide-y divide-gray-200">
<thead>
<tr>
<th class="px-6 py-3">Name</th>
<th class="px-6 py-3">Last Name</th>
<th class="px-6 py-3">Role</th>
<th class="px-6 py-3 text-center">Actions</th>
</tr>
</thead>
<tbody class="bg-white divide-y divide-gray-200" id="manageSecondaryMembersTableBody">
<tr><td class="text-center py-4 text-gray-500" colspan="4">No family members found.</td></tr>
</tbody>
</table>
</div>
<h2 class="text-xl font-bold text-gray-800 mb-4 mt-8">Add New Secondary Member:</h2>
<form id="manageSecondaryAddForm">
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div class="form-group">
<label for="manageSecondaryName">First Name:</label>
<input id="manageSecondaryName" required="" type="text"/>
</div>
<div class="form-group">
<label for="manageSecondaryLastName">Last Name:</label>
<input id="manageSecondaryLastName" required="" type="text"/>
</div>
<div class="form-group">
<label for="manageSecondaryPhone">Phone (Optional):</label>
<input id="manageSecondaryPhone" placeholder="e.g., 123-456-7890" type="tel"/>
</div>
<div class="form-group">
<label for="manageSecondaryBirthday">Birthday (Optional):</label>
<input id="manageSecondaryBirthday" type="date"/>
</div>
<div class="form-group">
<label for="manageSecondaryGender">Gender (Optional):</label>
<select id="manageSecondaryGender">
<option value="">Select Gender</option>
<option value="true">Male</option>
<option value="false">Female</option>
</select>
</div>
</div>
<div class="action-buttons">
<button class="action-button btn-primary" type="submit">Add Secondary Member</button>
<button class="action-button btn-secondary" id="manageSecondaryCloseBtn" type="button">Done</button>
</div>
</form>
</section>
<section class="view-container hidden" id="addVisitView">
<h1 class="text-3xl font-extrabold text-center text-gray-900 mb-6">
<span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-800 to-indigo-900">
                    Record New Visit
                </span>
</h1>
<form id="addVisitForm">
<div class="form-group">
<label for="addVisitMemberId">Member ID:</label>
<input disabled="" id="addVisitMemberId" type="text"/>
</div>
<div class="form-group">
<label for="addVisitName">First Name:</label>
<input disabled="" id="addVisitName" type="text"/>
</div>
<div class="form-group">
<label for="addVisitLastName">Last Name:</label>
<input disabled="" id="addVisitLastName" type="text"/>
</div>
<div class="form-group">
<label for="addVisitDateTime">Visit Date and Time:</label>
<input id="addVisitDateTime" required="" type="datetime-local"/>
</div>
<div class="action-buttons">
<button class="action-button btn-primary" type="submit">Record Visit</button>
<button class="action-button btn-secondary" id="addVisitCancelBtn" type="button">Cancel</button>
</div>
</form>
</section>
<section class="view-container hidden" id="memberVisitsView">
<h1 class="text-3xl font-extrabold text-center text-gray-900 mb-6">
<span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-800 to-indigo-900">
                    Visit History for: <span id="memberVisitsDisplayName"></span> (<span id="memberVisitsDisplayId"></span>)
                </span>
</h1>
<div class="mb-6 p-4 bg-purple-50 rounded-lg border border-purple-200 text-purple-800 font-semibold text-lg text-center">
                Total Visits: <span id="visitsSinceMembershipCount">0</span>
</div>
<h2 class="section-header">Visit Calendar</h2>
<div class="calendar" id="calendarContainer">
<div class="calendar-header">
<button id="prevMonthBtn">&lt;</button>
<span id="currentMonthYear"></span>
<button id="nextMonthBtn">&gt;</button>
</div>
<div class="calendar-weekdays">
<span>Sun</span><span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span>
</div>
<div class="calendar-days" id="calendarDays">
</div>
</div>
<h2 class="section-header mt-8">All Other Visits</h2>
<div class="all-visits-scroll-area" id="allOtherVisitsContainer">
<p class="text-gray-600 text-center py-4">No older visits to display.</p>
</div>
<div class="action-buttons">
<button class="action-button btn-secondary" id="memberVisitsCloseBtn" type="button">Close</button>
</div>
</section>
<section class="view-container hidden" id="accountManagementView">
<h1 class="text-3xl font-extrabold text-center text-gray-900 mb-6">
<span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-800 to-indigo-900">
                    Manage Account Password
                </span>
</h1>
<form id="accountManagementForm">
<div class="form-group">
<label for="currentPassword">Current Database Password:</label>
<input id="currentPassword" required="" type="password"/>
</div>
<div class="form-group">
<label for="newPassword">New Database Password:</label>
<input id="newPassword" required="" type="password"/>
</div>
<div class="form-group">
<label for="confirmNewPassword">Confirm New Password:</label>
<input id="confirmNewPassword" required="" type="password"/>
</div>
<div class="action-buttons">
<button class="action-button btn-primary" type="submit">Change Password</button>
<button class="action-button btn-secondary" id="accountManagementCancelBtn" type="button">Cancel</button>
</div>
</form>
</section>
</div>
<div class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50" id="todaysVisitsModal">
<div class="relative top-20 mx-auto p-5 border w-full max-w-lg shadow-lg rounded-md bg-white">
<div class="mt-3 text-center">
<h3 class="text-2xl leading-6 font-bold text-gray-900 mb-4">Visitors Today</h3>
<div class="mt-2 px-7 py-3 max-h-96 overflow-y-auto">
<table class="min-w-full divide-y divide-gray-200">
<thead class="bg-gray-50">
<tr>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" scope="col">Name</th>
<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" scope="col">Time of Visit</th>
</tr>
</thead>
<tbody class="bg-white divide-y divide-gray-200" id="todaysVisitsTableBody">
</tbody>
</table>
<p class="hidden text-gray-500 py-4" id="noVisitsMessage">No visits have been recorded yet today.</p>
</div>
<div class="items-center px-4 py-3">
<button class="px-4 py-2 bg-purple-800 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-purple-900 focus:outline-none focus:ring-2 focus:ring-purple-300" id="closeTodaysVisitsModalBtn">
                        Close
                    </button>
</div>
</div>
</div>
</div>



<script>
const BASE_API_URL = 'https://7vyy10lcgd.execute-api.us-east-1.amazonaws.com/api';

fetch(BASE_API_URL + '/data')
  .then(async (response) => {
    const contentType = response.headers.get("content-type");
    if (!response.ok) {
      throw new Error('HTTP error: ' + response.status);
    }
    if (!contentType || !contentType.includes('application/json')) {
      const text = await response.text();
      throw new Error('Expected JSON but got HTML:\n' + text.substring(0, 300));
    }
    return response.json();
  })
  .then(data => {
    console.log('Rendering records...', data);
    const tbody = document.querySelector('#recordsTable tbody');
    if (!tbody) {
      console.error('Could not find #recordsTable tbody');
      return;
    }

    tbody.innerHTML = data.map(function(record) {
      return '<tr>' +
        '<td>' + record.member_id + '</td>' +
        '<td>' + record.name + ' ' + record.last_name + '</td>' +
        '<td>' + (record.email || '') + '</td>' +
        '<td>' + (record.membership_expires || '') + '</td>' +
        '<td>' + (record.active_flag ? 'Active' : 'Inactive') + '</td>' +
        '</tr>';
    }).join('');
  })
  .catch(error => {
    console.error('Failed to fetch and render records:', error);
    const tbody = document.querySelector('#recordsTable tbody');
    if (tbody) {
      tbody.innerHTML = '<tr><td colspan="5">Error loading data</td></tr>';
    }
  });
</script>

</body>
</html>